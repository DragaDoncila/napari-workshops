
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>notebook: bioimage visualization in python &#8212; napari workshops</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet" />
  <link href="../_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/sphinx-book-theme.5f77b4aec8189eecf79907ce328c390d.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.1c5a1a01449ed65a7b51.js">

    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="prev" title="python setup &amp; napari installation" href="../NDCN-0821/installation.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
      <img src="../_static/logo.ico" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">napari workshops</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../home.html">
   Home
  </a>
 </li>
</ul>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="../NDCN-0821/intro.html">
   NDCN Workshop 08/21
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="../NDCN-0821/installation.html">
     python setup &amp; napari installation
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     notebook: bioimage visualization in python
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        <a class="dropdown-buttons"
            href="../_sources/notebooks/intro_bioimage_visualization.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download notebook file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/notebooks/intro_bioimage_visualization.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.md</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/executablebooks/jupyter-book"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2Fnotebooks/intro_bioimage_visualization.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/executablebooks/jupyter-book/master?urlpath=tree/napari-workshops/notebooks/intro_bioimage_visualization.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#introducing-napari">
   Introducing napari
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#visualizing-data-with-napari">
   Visualizing data with napari
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#seeing-our-first-image">
     Seeing our first image
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#color-channels-and-blending">
     Color channels and blending
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#orthogonal-slicing-and-3d-rendering">
     Orthogonal slicing and 3D rendering
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#conclusions">
   Conclusions
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="notebook-bioimage-visualization-in-python">
<h1>notebook: bioimage visualization in python<a class="headerlink" href="#notebook-bioimage-visualization-in-python" title="Permalink to this headline">¶</a></h1>
<p>Python has a rich selection of <a class="reference external" href="https://pyviz.org/index.html">data visualization</a> tools that cover wide range of applications, for example
Matplotlib (Hunter, 2007), Mayavi (Ramachandran &amp; Varoquaux, 2011), <a class="reference external" href="https://github.com/maartenbreddels/ipyvolume/">ipyvolume</a>, the yt Project
(Turk et al., 2010), <a class="reference external" href="https://itk.org/">ITK</a> (Johnson, McCormick, Ibanez 2015), and more recently <strong><a class="reference external" href="http://napari.org">napari</a></strong>.</p>
<p>For <strong>bioimage visualization</strong> some major challenges are:</p>
<ul class="simple">
<li><p>working with large and complex images: image size and dimensionality</p></li>
<li><p>manual interactivity: for human in the loop annotation</p></li>
<li><p>interactive analysis: for interactive parameter tuning and quality control</p></li>
</ul>
<p>This notebook will introduce <code class="docutils literal notranslate"><span class="pre">napari</span></code> a fast, interactive, multi-dimensional image viewer for Python.</p>
<div class="section" id="introducing-napari">
<h2>Introducing napari<a class="headerlink" href="#introducing-napari" title="Permalink to this headline">¶</a></h2>
<a class="reference internal image-reference" href="notebooks/resources/napari-logo.png"><img alt="napari layer types" class="align-center" src="notebooks/resources/napari-logo.png" style="width: 20%;" /></a>
<p><code class="docutils literal notranslate"><span class="pre">napari</span></code> is a fast, interactive, multi-dimensional image viewer for Python. It’s designed for browsing, annotating, and analyzing large multi-dimensional images. It’s built on top of Qt (for the GUI), vispy (for performant GPU-based rendering), and the scientific Python stack (numpy, scipy).</p>
<p><code class="docutils literal notranslate"><span class="pre">napari</span></code> includes critical viewer features out-of-the-box, such as support for large multi-dimensional data, layering, and annotation. By integrating closely with the scientific Python ecosystem, napari can be easily coupled to leading machine learning and image analysis tools (e.g. scikit-image, scikit-learn, PyTorch), enabling more user-friendly automated analysis.</p>
<a class="reference internal image-reference" href="notebooks/resources/napari-layer-types.png"><img alt="napari layer types" class="align-center" src="notebooks/resources/napari-layer-types.png" style="width: 20%;" /></a>
<p><code class="docutils literal notranslate"><span class="pre">napari</span></code> supports seven different layer types, <strong>Image</strong>, <strong>Labels</strong>, <strong>Points</strong>, <strong>Vectors</strong>, <strong>Shapes</strong>, <strong>Surface</strong> and <strong>Tracks</strong>. Each layer corresponds to a different data type and has it’s own set of visualizations and interactive controls. We provide an <a class="reference external" href="https://napari.org/tutorials/index.html">associated tutorial</a> for each layer type to help you get started!</p>
<p>You can add multiple layers of different types into the viewer and work with them, adjusting their properties and performing analysis.</p>
<p><code class="docutils literal notranslate"><span class="pre">napari</span></code> also supports bidirectional communication between the viewer and the Python kernel, which is especially useful when launching from jupyter notebooks or when using our built-in console. Using the console allows you to interactively load and save data from the viewer and control all the features of the viewer programmatically.</p>
<p>You can (and are encouraged to!) extend <code class="docutils literal notranslate"><span class="pre">napari</span></code> using custom <a class="reference external" href="https://napari.org/guides/stable/connecting_events.html#listening-for-keypress-events">key bindings</a>, <a class="reference external" href="https://napari.org/guides/stable/connecting_events.html#listening-for-mouse-events">mouse functions</a>, and our new <a class="reference external" href="https://napari.org/plugins/stable/for_plugin_developers.html"><strong>plugin-interface</strong></a>.</p>
<p>Learn more about napari at <a class="reference external" href="https://napari.org/">napari.org</a>, including our <a class="reference external" href="https://napari.org/tutorials/">tutorials</a>, our <a class="reference external" href="https://napari.org/docs/">documentation</a> and our <a class="reference external" href="https://napari.org/docs/developers/MISSION_AND_VALUES.html">mission and values</a>.</p>
</div>
<div class="section" id="visualizing-data-with-napari">
<h2>Visualizing data with napari<a class="headerlink" href="#visualizing-data-with-napari" title="Permalink to this headline">¶</a></h2>
<p>Let’s start by importing napari and creating an empty <a class="reference external" href="https://napari.org/tutorials/fundamentals/viewer.html">napari viewer</a></p>
<div class="cell tag_hide-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">napari</span>
<span class="n">viewer</span> <span class="o">=</span> <span class="n">napari</span><span class="o">.</span><span class="n">Viewer</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ModuleNotFoundError</span><span class="g g-Whitespace">                       </span>Traceback (most recent call last)
<span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">ipykernel_1726</span><span class="o">/</span><span class="mf">911341563.</span><span class="n">py</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="kn">import</span> <span class="nn">napari</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="n">viewer</span> <span class="o">=</span> <span class="n">napari</span><span class="o">.</span><span class="n">Viewer</span><span class="p">()</span>

<span class="ne">ModuleNotFoundError</span>: No module named &#39;napari&#39;
</pre></div>
</div>
</div>
</div>
<p>Hopfully when you ran the above command a new empty napari viewer appeared in a seperate window.</p>
<p>Unlike other jupyter widgets, napari is not embedded inside the jupyter notebook. This is because the graphical parts of napari are written in <a class="reference external" href="https://www.qt.io/">Qt</a>, making it hard to embed on the web.</p>
<p>Instead, we can take a screenshot of the current state of napari viewer and embed that in the notebook. This can be useful for teaching or sharing purposes where you might want to share key steps in an analysis which makes use of interactive components.</p>
<p>To do this, we use the <code class="docutils literal notranslate"><span class="pre">nbscreenshot</span></code> utility function</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">napari.utils</span> <span class="kn">import</span> <span class="n">nbscreenshot</span>

<span class="n">nbscreenshot</span><span class="p">(</span><span class="n">viewer</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Unfortunately, in contrast with the real napari viewer, these screenshots won’t be interactive!</p>
</div>
<div class="section" id="seeing-our-first-image">
<h3>Seeing our first image<a class="headerlink" href="#seeing-our-first-image" title="Permalink to this headline">¶</a></h3>
<p>There are a few different ways to load images to into our <code class="docutils literal notranslate"><span class="pre">viewer</span></code>.</p>
<ul class="simple">
<li><p>By <code class="docutils literal notranslate"><span class="pre">dragging</span> <span class="pre">and</span> <span class="pre">dropping</span></code> image files onto the viewer</p></li>
<li><p>By selection image files from the <code class="docutils literal notranslate"><span class="pre">Open</span> <span class="pre">File(s)</span></code> menu option</p></li>
<li><p>Using the <code class="docutils literal notranslate"><span class="pre">viewer.open</span></code> command with a file path from within the notebook</p></li>
<li><p>Loading the image data into an array and then passing that array using the <code class="docutils literal notranslate"><span class="pre">viewer.add_image</span></code> command</p></li>
</ul>
<p>For the first three options the file path will get passed through our fileIO plugin interface, allowing you to easily leverage highly customized fileIO plugins for your diverse needs. The fourth option allows you complete control over loading and visualization and is most suited for when you have data already loaded into your notebook from other sources.</p>
<p>Here we will explore the fourth option, explicitly loading a 3D image using the <code class="docutils literal notranslate"><span class="pre">tifffile</span></code> library and the <code class="docutils literal notranslate"><span class="pre">add_image()</span></code> method of our <code class="docutils literal notranslate"><span class="pre">Viewer</span></code> object.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">tifffile</span> <span class="kn">import</span> <span class="n">imread</span>

<span class="c1"># load the image data and inspect its shape</span>
<span class="n">nuclei</span> <span class="o">=</span> <span class="n">imread</span><span class="p">(</span><span class="s1">&#39;data/nuclei.tif&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">nuclei</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Now that we have the data array loaded, we can directly add it to the viewer.</p>
<div class="cell tag_remove-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## directly adding image data to the napari viewer</span>
<span class="n">viewer</span><span class="o">.</span><span class="n">add_image</span><span class="p">(</span><span class="n">nuclei</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Don’t forget to change windows so you can now see the viewer. By default you’ll just be looking at the 1st plane of the 3D data, which is the 0th slice of 60. You should see a single slider at the buttom of the viewer that will allow you to scroll through the rest of the z-stack. If you find the 30th slice then you should see the same as in the screenshot below.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nbscreenshot</span><span class="p">(</span><span class="n">viewer</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>In the top left hand corner of the viewer we now have a control panel with controls that cover all our layers, and those that are specific to images like contrast limits and colormap.</p>
</div>
<div class="section" id="color-channels-and-blending">
<h3>Color channels and blending<a class="headerlink" href="#color-channels-and-blending" title="Permalink to this headline">¶</a></h3>
<p>Right clicking on the <strong>contrast limits</strong> slider pulls up an elongated version of the slider which you can type specific numbers into. Let’s give that a try to adjust the contrast limits to <code class="docutils literal notranslate"><span class="pre">[0.07,</span> <span class="pre">0.35]</span></code>, and let’s change the colormap to <code class="docutils literal notranslate"><span class="pre">blue</span></code> using the drop down menu.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nbscreenshot</span><span class="p">(</span><span class="n">viewer</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>One of the real strengths of napari is that you have full control over all the critical layer properties both programmatically and via the GUI.</p>
<p>Each <code class="docutils literal notranslate"><span class="pre">layer</span></code> that is added to the <code class="docutils literal notranslate"><span class="pre">viewer</span></code> can be found in the <code class="docutils literal notranslate"><span class="pre">viewer.layers</span></code> list which can be indexed either numerically or by the layer name, which is visible in the panel in the bottom left of the viewer. This layer has the name <code class="docutils literal notranslate"><span class="pre">nuclei</span></code>, which was automatically imputed because we originally named the variable we loaded from disk <code class="docutils literal notranslate"><span class="pre">nuclei</span></code>. Pretty cool!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># let&#39;s see what the layers list has in it right now</span>
<span class="nb">print</span><span class="p">(</span><span class="n">viewer</span><span class="o">.</span><span class="n">layers</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nuclei_layer</span> <span class="o">=</span> <span class="n">viewer</span><span class="o">.</span><span class="n">layers</span><span class="p">[</span><span class="s1">&#39;nuclei&#39;</span><span class="p">]</span>
<span class="n">first_layer</span> <span class="o">=</span> <span class="n">viewer</span><span class="o">.</span><span class="n">layers</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">nuclei_layer</span><span class="p">,</span> <span class="n">first_layer</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>If we go in and get the <code class="docutils literal notranslate"><span class="pre">nuclei</span></code> layer from our layer list we can now see and edit the values of some of the properties that we can control in the GUI.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># let&#39;s look at the values of some of the properties on the `nuclei` layer</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Colormap: &#39;</span><span class="p">,</span> <span class="n">viewer</span><span class="o">.</span><span class="n">layers</span><span class="p">[</span><span class="s1">&#39;nuclei&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">colormap</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Contrast limits: &#39;</span><span class="p">,</span> <span class="n">viewer</span><span class="o">.</span><span class="n">layers</span><span class="p">[</span><span class="s1">&#39;nuclei&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">contrast_limits</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Opacity: &#39;</span><span class="p">,</span> <span class="n">viewer</span><span class="o">.</span><span class="n">layers</span><span class="p">[</span><span class="s1">&#39;nuclei&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">opacity</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Now let&#39;s change some of them. Note that the viewer GUI will update in real time as you run this code in the notebook</span>
<span class="n">viewer</span><span class="o">.</span><span class="n">layers</span><span class="p">[</span><span class="s1">&#39;nuclei&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">colormap</span> <span class="o">=</span> <span class="s1">&#39;red&#39;</span>
<span class="n">viewer</span><span class="o">.</span><span class="n">layers</span><span class="p">[</span><span class="s1">&#39;nuclei&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">contrast_limits</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">]</span>
<span class="n">viewer</span><span class="o">.</span><span class="n">layers</span><span class="p">[</span><span class="s1">&#39;nuclei&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">opacity</span> <span class="o">=</span> <span class="mf">0.9</span>

<span class="c1"># We can even rename the layer, but note that from now on you&#39;ll need to refer to if with its new name</span>
<span class="n">viewer</span><span class="o">.</span><span class="n">layers</span><span class="p">[</span><span class="s1">&#39;nuclei&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;division&#39;</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nbscreenshot</span><span class="p">(</span><span class="n">viewer</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>We could have actually passed these parameters as key-word arguments to during the first <code class="docutils literal notranslate"><span class="pre">add_image</span></code> call. For example we can add another copy of the data as follows:</p>
<div class="cell tag_remove-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">viewer</span><span class="o">.</span><span class="n">add_image</span><span class="p">(</span><span class="n">nuclei</span><span class="p">,</span> <span class="n">contrast_limits</span><span class="o">=</span><span class="p">[</span><span class="mf">0.07</span><span class="p">,</span> <span class="mf">0.35</span><span class="p">],</span> <span class="n">colormap</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">blending</span><span class="o">=</span><span class="s1">&#39;additive&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Setting the <code class="docutils literal notranslate"><span class="pre">blending</span></code> of the second layer to <code class="docutils literal notranslate"><span class="pre">additive</span></code> now lets us see both together, which could be useful for understanding how parts of the image relate to each other.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nbscreenshot</span><span class="p">(</span><span class="n">viewer</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Let’s now load in an additional channel of data containting a stain for cell membranes and add them to the viewer as a new layer.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">tifffile</span> <span class="kn">import</span> <span class="n">imread</span>

<span class="c1"># load the image data and inspect its shape</span>
<span class="n">membranes</span> <span class="o">=</span> <span class="n">imread</span><span class="p">(</span><span class="s1">&#39;data/cell_membranes.tif&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">membranes</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">viewer</span><span class="o">.</span><span class="n">add_image</span><span class="p">(</span><span class="n">membranes</span><span class="p">,</span> <span class="n">contrast_limits</span><span class="o">=</span><span class="p">[</span><span class="mf">0.02</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">],</span> <span class="n">colormap</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="n">blending</span><span class="o">=</span><span class="s1">&#39;additive&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nbscreenshot</span><span class="p">(</span><span class="n">viewer</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="orthogonal-slicing-and-3d-rendering">
<h3>Orthogonal slicing and 3D rendering<a class="headerlink" href="#orthogonal-slicing-and-3d-rendering" title="Permalink to this headline">¶</a></h3>
<p>So far we’ve only looked at one slice. Use the slider at the bottom of the viewer to scroll through to another slice and see what the image looks like. For example the 45th slice looks like:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nbscreenshot</span><span class="p">(</span><span class="n">viewer</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>As this is a 3D volume, we can also use napari to look at 2D slices along other axes. If we click the <code class="docutils literal notranslate"><span class="pre">roll</span> <span class="pre">dimensions</span></code> button in the bottom left hand corner of the viewer (which looks like a 3D cube with an arrow, 3rd from the left), and then scrolling through to the 60th slice gives the following:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nbscreenshot</span><span class="p">(</span><span class="n">viewer</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>In addition to doing 2D rendering, napari can also do full 3D rendering. To enable 3D mode click on the 3D rendering button (which looks like a wireframe of a cube, second from the left). Now the slider has disappeared as the full 3D volume is being rendered at the same time. If the original dataset had been 4D, say for a volumteric timeseries then when using 2D rendering we would have initially seen two sliders, one for Z and one for Time, and 3D rendering would have switched us to only seeing one slider, for Time. In this way napari can be used to visualize either 2D or 3D slices of full n-Dimensional data with multiple color channels.</p>
<p>Try playing around with some of the 3D rendering modes and parameters in the gui to get a nice 3D visualization.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nbscreenshot</span><span class="p">(</span><span class="n">viewer</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="conclusions">
<h2>Conclusions<a class="headerlink" href="#conclusions" title="Permalink to this headline">¶</a></h2>
<p>We’ve now seen how to use napari to visualize 3D images, including looking at 2D slices and the full 3D image. We’ve also learnt how to change properties of an image layer both from the GUI and from the jupyter notebook.</p>
<p>The next lessons will teach us how to create napari layers of other types, perform manual annotations, interactive analyses and more!</p>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./notebooks"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
        <div class='prev-next-bottom'>
            
    <a class='left-prev' id="prev-link" href="../NDCN-0821/installation.html" title="previous page">python setup &amp; napari installation</a>

        </div>
        
        </div>
    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By napari core developers<br/>
        
            &copy; Copyright 2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  
  </body>
</html>